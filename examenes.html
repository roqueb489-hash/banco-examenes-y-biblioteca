<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Banco de Exámenes - IEP San Luis Gonzaga</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{--bg:#0f172a;--s:#1e293b;--t:#e2e8f0;--az:#1e40af;--am:#fbbf24;--rojo:#dc2626}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--t);padding-top:80px;overflow-x:hidden}
header{background:var(--s);position:fixed;top:0;left:0;right:0;z-index:99;padding:1rem;text-align:center;box-shadow:0 4px 20px rgba(0,0,0,0.5)}
header h1{font-size:2.5rem;color:var(--am);font-weight:900}
.container{max-width:1400px;margin:0 auto;padding:2rem}
.section-title{font-size:2.8rem;color:var(--am);text-align:center;margin:4rem 0 2rem}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:2rem;margin-bottom:2rem}
.card{background:var(--s);border-radius:20px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.5);transition:.3s;cursor:pointer}
.card:hover{transform:translateY(-10px)}
.card img{height:200px;width:100%;object-fit:cover}
.card h3{padding:1rem;font-size:1.35rem;text-align:center;font-weight:700}
.btns{text-align:center;padding:1rem}
.btn{padding:0.8rem 1.5rem;margin:0.5rem;border-radius:12px;text-decoration:none;font-weight:700;display:inline-block}
.ver{background:var(--az);color:white}
.desc{background:var(--am);color:black}
.subir{background:var(--s);border:3px dashed var(--az);border-radius:20px;padding:3rem;text-align:center;margin:4rem 0}
.subir button{background:var(--am);color:black;padding:1rem 3rem;border:none;border-radius:50px;font-size:1.4rem;font-weight:900;cursor:pointer}
.loading{text-align:center;padding:6rem;font-size:1.6rem;color:#888}
</style>
</head>
<body>

<header>
  <h1>BANCO DE EXÁMENES</h1>
  <a href="index.html" style="position:absolute;left:20px;top:20px;color:white;font-size:2rem">
    <i class="fas fa-arrow-left"></i> Volver
  </a>
</header>

<div class="container">
  <div class="loading" id="loading">Cargando exámenes...</div>

  <!-- ÁREA I -->
  <h2 class="section-title">Área I</h2>
  <div class="cards" id="area1"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN ÁREA I
    </button>
  </div>

  <!-- ÁREA II -->
  <h2 class="section-title">Área II</h2>
  <div class="cards" id="area2"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN ÁREA II
    </button>
  </div>

  <!-- ÁREA III -->
  <h2 class="section-title">Área III</h2>
  <div class="cards" id="area3"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN ÁREA III
    </button>
  </div>

  <!-- ÁREA IV -->
  <h2 class="section-title">Área IV</h2>
  <div class="cards" id="area4"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN ÁREA IV
    </button>
  </div>

  <!-- ÁREA V -->
  <h2 class="section-title">Área V</h2>
  <div class="cards" id="area5"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN ÁREA V
    </button>
  </div>

  <!-- CONCURSOS -->
  <h2 class="section-title">Concursos Interescolares</h2>
  <div class="cards" id="area6"></div>
  <div class="subir">
    <button onclick="window.open('https://drive.google.com/drive/folders/1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm','_blank')">
      SUBIR EXAMEN DE CONCURSO
    </button>
  </div>
</div>

<script>
const DEPLOY_URL = "https://script.google.com/macros/s/AKfycbxoPNW7IPyuiP1nUxkhiWCDnYtLFNO4iv-YXaHQPyuGsaRJ3vsBWJnUWyro1I1Q6eCw2w/exec";
const CARPETA_ID = "1dyNvIL3nEfyjUVLyKgSbwIj-GF6KcNCm";

const areas = {
  1: document.getElementById('area1'),
  2: document.getElementById('area2'),
  3: document.getElementById('area3'),
  4: document.getElementById('area4'),
  5: document.getElementById('area5'),
  6: document.getElementById('area6')
};

async function cargar() {
  try {
    const res = await fetch(`${DEPLOY_URL}?carpeta=${CARPETA_ID}`);
    const archivos = await res.json();

    // Limpiar todas las áreas
    Object.values(areas).forEach(a => a.innerHTML = '');

    if (archivos.length === 0) {
      Object.values(areas).forEach(a => {
        a.innerHTML = '<p style="grid-column:1/-1;text-align:center;padding:4rem;color:#888">Aún no hay exámenes</p>';
      });
      return;
    }

    archivos.forEach(f => {
      const nombre = f.name.replace(/\.pdf$/i, '');
      const minus = nombre.toLowerCase();

      // CLASIFICACIÓN MUY FUERTE (ya no se confunde nada)
      let area = 6; // por defecto concursos
      if (/(^|\s)área\s*1\b|(^|\s)area\s*1\b|área\s*i\b/i.test(minus)) area = 1;
      else if (/(^|\s)área\s*2\b|(^|\s)area\s*2\b|área\s*ii\b/i.test(minus)) area = 2;
      else if (/(^|\s)área\s*3\b|(^|\s)area\s*3\b|área\s*iii\b/i.test(minus)) area = 3;
      else if (/(^|\s)área\s*4\b|(^|\s)area\s*4\b|área\s*iv\b/i.test(minus)) area = 4;
      else if (/(^|\s)área\s*5\b|(^|\s)area\s*5\b|área\s*v\b/i.test(minus)) area = 5;

      const card = `
        <div class="card">
          <img src="https://drive.google.com/thumbnail?id=${f.id}&sz=w400" alt="${nombre}"
               onerror="this.src='https://via.placeholder.com/340x200/1e293b/ffffff?text=Examen'">
          <h3>${nombre}</h3>
          <div class="btns">
            <a href="https://drive.google.com/file/d/${f.id}/preview" target="_blank" class="btn ver">Ver</a>
            <a href="https://drive.google.com/uc?id=${f.id}&export=download" class="btn desc">Descargar</a>
          </div>
        </div>`;

      areas[area].innerHTML += card;
    });

  } catch (e) {
    Object.values(areas).forEach(a => {
      a.innerHTML = '<p style="color:#ff6b6b;text-align:center">Error de conexión</p>';
    });
  } finally {
    document.getElementById('loading').style.display = 'none';
  }
}

cargar();
</script>
</body>
</html>
