<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biblioteca Digital Sanluisina | IEP San Luis Gonzaga</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Playfair+Display:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
<style>
:root{--primary:#003087;--secondary:#0146c6;--accent:#FFD700;--light:#f8f9fa;--dark:#1e293b;--gray:#64748b;--danger:#ef4444;--card-shadow:0 8px 25px rgba(0,48,135,0.12);--card-shadow-hover:0 25px 50px rgba(0,48,135,0.22);--transition:all .4s cubic-bezier(.4,0,.2,1);--radius:20px}
[data-theme="dark"]{--light:#0f172a;--dark:#000;--gray:#94a3b8}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--light);color:var(--dark);line-height:1.6;transition:var(--transition);overflow-x:hidden;padding-left:280px}
.sidebar{position:fixed;left:0;top:0;width:280px;height:100vh;background:linear-gradient(180deg,var(--primary),var(--secondary));color:white;z-index:999;display:flex;flex-direction:column;box-shadow:8px 0 30px rgba(0,48,135,0.3);overflow-y:auto}
.sidebar-header{padding:2.8rem 1.5rem 2.2rem;text-align:center;border-bottom:1px solid rgba(255,255,255,0.15)}
.sidebar-logo-big{width:158px;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.6));margin-bottom:16px;border-radius:22px;background:rgba(255,255,255,0.18);padding:14px}
.sidebar-header h2{font-family:'Playfair Display',serif;font-size:1.85rem;line-height:1.2}
.nav-item{display:flex;align-items:center;gap:16px;padding:1.1rem 2rem;color:rgba(255,255,255,0.92);text-decoration:none;font-weight:500;transition:all .35s}
.nav-item:hover{background:rgba(255,255,255,0.18);padding-left:2.4rem}
.nav-item.active{background:rgba(255,255,255,0.28);font-weight:700;border-left:6px solid var(--accent);padding-left:2.4rem}
.hero{height:100vh;min-height:620px;background:linear-gradient(rgba(0,48,135,0.95),rgba(0,48,135,0.88)),url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?w=1920') center/cover;display:flex;align-items:center;justify-content:center;text-align:center;color:white}
.hero-content{gap:20px;display:flex;flex-direction:column;align-items:center}
.hero-logo-big{width:190px;filter:drop-shadow(0 10px 25px rgba(0,0,0,0.7))}
.hero-content h1{font-family:'Playfair Display',serif;font-size:clamp(3rem,8vw,5.8rem);text-shadow:0 8px 20px rgba(0,0,0,0.6);font-weight:900}
.search-bar input{padding:18px 30px;max-width:600px;border:none;border-radius:50px;font-size:1.15rem;box-shadow:0 15px 40px rgba(0,48,135,0.5);outline:none}
.container{max-width:1400px;margin:0 auto;padding:0 30px}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1.8rem;padding:2rem 0}
.card{background:white;border-radius:20px;overflow:hidden;box-shadow:var(--card-shadow);transition:var(--transition);border:3px solid var(--accent)}
.card:hover{transform:translateY(-14px);box-shadow:var(--card-shadow-hover)}
.card img{width:100%;height:170px;object-fit:cover}
.content{padding:1.4rem 1.3rem 1.3rem}
.category-badge{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:8px 14px;border-radius:50px;font-size:0.73rem;font-weight:700;margin-bottom:12px}
.card h3{font-family:'Playfair Display',serif;font-size:1.38rem;font-weight:800;line-height:1.26;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.action-buttons{display:flex;flex-direction:column;gap:10px;margin-top:14px}
.read-btn,.download-btn{border-radius:14px;font-weight:600;transition:all .35s;display:flex;align-items:center;justify-content:center;gap:10px;font-size:0.94rem;padding:11px 16px}
.read-btn{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border:none;box-shadow:0 6px 20px rgba(0,48,135,0.35);cursor:pointer}
.download-btn{background:#dc2626;color:white;box-shadow:0 6px 20px rgba(220,38,38,0.35)}
.add-book-card{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border-radius:var(--radius);padding:2.5rem 1.5rem;text-align:center;box-shadow:var(--card-shadow);transition:var(--transition);cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;min-height:420px}
.add-book-card:hover{transform:translateY(-16px);box-shadow:var(--card-shadow-hover)}
.add-book-card i{font-size:5.5rem}
.add-book-card span{font-family:'Playfair Display',serif;font-size:2.1rem;font-weight:900}
.controls{position:fixed;top:90px;right:20px;z-index:999;display:flex;flex-direction:column;gap:16px}
.control-btn{width:56px;height:56px;border-radius:50%;background:var(--primary);color:white;border:none;cursor:pointer;box-shadow:0 6px 20px rgba(0,48,135,0.35);font-size:1.35rem}
#scrollTop{position:fixed;bottom:30px;right:30px;width:58px;height:58px;background:var(--primary);color:white;border:none;border-radius:50%;font-size:1.7rem;cursor:pointer;box-shadow:0 8px 25px rgba(0,48,135,0.4);opacity:0;visibility:hidden;transition:var(--transition)}
#scrollTop.visible{opacity:1;visibility:visible}
.menu-toggle{display:none;position:fixed;top:20px;left:20px;z-index:1002;background:var(--primary);color:white;border:none;width:62px;height:62px;border-radius:50%;font-size:1.8rem;cursor:pointer;box-shadow:0 8px 25px rgba(0,48,135,0.5)}
@media (max-width:992px){body{padding-left:0}.sidebar{transform:translateX(-100%)}.sidebar.active{transform:translateX(0)}.menu-toggle{display:block}}
.upload-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.92);backdrop-filter:blur(12px);z-index:3000;align-items:center;justify-content:center;padding:20px}
.upload-modal.active{display:flex}
.upload-box{background:white;border-radius:24px;width:96%;max-width:560px;padding:2.8rem 2.2rem;box-shadow:0 30px 80px rgba(0,48,135,0.4);position:relative}
.upload-box h2{text-align:center;margin-bottom:2rem;color:var(--primary);font-family:'Playfair Display',serif;font-size:2.4rem}
.form-group{margin-bottom:1.4rem}
.form-group label{display:block;margin-bottom:8px;font-weight:600;color:#333}
.form-group input[type="text"],.form-group input[type="file"]{width:100%;padding:14px 16px;border:2px solid #e2e8f0;border-radius:14px;font-size:1rem}
.form-group input[type="file"]{padding:40px;text-align:center;background:#f8fafc;cursor:pointer}
.upload-btn{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border:none;padding:16px;border-radius:16px;font-size:1.2rem;font-weight:700;cursor:pointer;width:100%;margin-top:1rem}
.close-upload{position:absolute;top:16px;right:20px;font-size:2.4rem;background:none;border:none;cursor:pointer;color:#94a3b8}
</style>
</head>
<body data-theme="light">

<button class="menu-toggle" id="menu-toggle">Menu</button>

<aside class="sidebar">
  <div class="sidebar-header">
    <img src="Insignia-New-cuadrado.png" alt="Logo" class="sidebar-logo-big" onerror="this.src='https://via.placeholder.com/158x158/003087/ffffff?text=Logo'">
    <h2>Biblioteca<br><span>Sanluisina</span></h2>
  </div>
  <nav>
    <a href="examenes.html" class="nav-item">Banco de Exámenes</a>
  </nav>
  <div class="sidebar-footer">
    <a href="#" class="nav-item active">Inicio Todos los libros</a>
    <a href="#" class="nav-item">Publicaciones Bíblicas</a>
    <a href="#" class="nav-item">Literatura Peruana</a>
    <a href="#" class="nav-item">Huánuco</a>
    <a href="#" class="nav-item">Creencias</a>
  </div>
</aside>

<div class="controls">
  <button class="control-btn" id="theme-toggle">Moon</button>
</div>
<button id="scrollTop">Up Arrow</button>

<section class="hero">
  <div class="hero-content">
    <img src="Insignia-New-cuadrado.png" alt="Logo" class="hero-logo-big">
    <h1>Biblioteca Digital Sanluisina</h1>
    <p>IEP San Luis Gonzaga - Huánuco</p>
    <div class="search-bar"><input type="text" id="global-search" placeholder="Busca por título o autor..."></div>
  </div>
</section>

<div class="container">
  <div class="cards" id="all-container"></div>
</div>

<!-- MODAL SUBIR LIBRO -->
<div class="upload-modal" id="upload-modal">
  <div class="upload-box">
    <button class="close-upload" onclick="document.getElementById('upload-modal').classList.remove('active')">X</button>
    <h2>Subir Nuevo Libro</h2>
    <div class="form-group">
      <label>Título del libro *</label>
      <input type="text" id="titulo-libro" placeholder="Ej: La Biblia Reina Valera">
    </div>
    <div class="form-group">
      <label>Archivo PDF *</label>
      <input type="file" id="file-libro" accept=".pdf">
    </div>
    <button class="upload-btn" onclick="subirLibro()">Subir Libro</button>
  </div>
</div>

<script type="module">
  const DEPLOY_URL = "https://script.google.com/macros/s/AKfycbztbSGkOzAxM6634AMXvjS9arvg_kpAd4wH70QDrQfNGmc1gbUuwQLfenp4jEcwsRk8/exec";
  const CARPETA_ID = "1OTD3mN_Owpp_TbtaWdM8UOOg6naaIT_4";

  async function cargarLibros() {
    const res = await fetch(`${DEPLOY_URL}?carpeta=${CARPETA_ID}`);
    const archivos = await res.json();
    const container = document.getElementById('all-container');
    container.innerHTML = '';

    // Botón gigante
    const boton = document.createElement('div');
    boton.className = 'add-book-card';
    boton.innerHTML = `<i class="fas fa-cloud-upload-alt"></i><span>Subir nuevo<br>libro</span><small>Click para agregar</small>`;
    boton.onclick = () => document.getElementById('upload-modal').classList.add('active');
    container.appendChild(boton);

    archivos.forEach(l => {
      const n = l.name.replace(/\.pdf$/i, '');
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="https://drive.google.com/thumbnail?id=${l.id}&sz=w400" onerror="this.src='https://via.placeholder.com/400x600/003087/ffffff?text=${encodeURIComponent(n)}'">
        <div class="content">
          <div class="category-badge">Libro</div>
          <h3>${n}</h3>
          <div class="action-buttons">
            <button class="read-btn" onclick="window.open('https://drive.google.com/file/d/${l.id}/preview','_blank')">Leer</button>
            <a href="https://drive.google.com/uc?id=${l.id}&export=download" class="download-btn">Descargar</a>
          </div>
        </div>`;
      container.appendChild(card);
    });

    gsap.fromTo('.card, .add-book-card', {y:50, opacity:0}, {y:0, opacity:1, stagger:0.1, duration:0.7});
  }

  function subirLibro() {
    const titulo = document.getElementById('titulo-libro').value.trim();
    const file = document.getElementById('file-libro').files[0];
    if (!titulo || !file) return alert('Completa título y archivo');
    window.open('https://drive.google.com/drive/folders/1OTD3mN_Owpp_TbtaWdM8UOOg6naaIT_4?usp=sharing', '_blank');
    document.getElementById('upload-modal').classList.remove('active');
    alert('Carpeta abierta. Arrastra el PDF y ponle el título que escribiste');
  }

  document.getElementById('theme-toggle').onclick = () => {
    const dark = document.body.getAttribute('data-theme') === 'dark';
    document.body.setAttribute('data-theme', dark ? 'light' : 'dark');
    document.getElementById('theme-toggle').innerHTML = dark ? 'Moon' : 'Sun';
  };

  window.onscroll = () => document.getElementById('scrollTop').classList.toggle('visible', window.scrollY > 500);
  document.getElementById('scrollTop').onclick = () => window.scrollTo({top:0, behavior:'smooth'});
  document.getElementById('menu-toggle').onclick = () => document.querySelector('.sidebar').classList.toggle('active');

  cargarLibros();
</script>
</body>
</html>
