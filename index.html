<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biblioteca Digital Sanluisina | IEP San Luis Gonzaga</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Playfair+Display:wght@700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
<style>
:root{--primary:#003087;--secondary:#0146c6;--accent:#FFD700;--light:#f8f9fa;--dark:#1e293b;--gray:#64748b;--danger:#ef4444;--card-shadow:0 8px 25px rgba(0,48,135,0.12);--card-shadow-hover:0 25px 50px rgba(0,48,135,0.22);--transition:all .4s cubic-bezier(.4,0,.2,1);--radius:20px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--light);color:var(--dark);line-height:1.6;transition:var(--transition);overflow-x:hidden;padding-left:280px}
.sidebar{position:fixed;left:0;top:0;width:280px;height:100vh;background:linear-gradient(180deg,var(--primary),var(--secondary));color:white;z-index:999;display:flex;flex-direction:column;box-shadow:8px 0 30px rgba(0,48,135,0.3);overflow-y:auto}
.sidebar-header{padding:2.8rem 1.5rem 2.2rem;text-align:center;border-bottom:1px solid rgba(255,255,255,0.15)}
.sidebar-logo-big{width:158px;border-radius:22px;background:rgba(255,255,255,0.18);padding:14px}
.hero{height:100vh;background:linear-gradient(rgba(0,48,135,0.95),rgba(0,48,135,0.88)),url('https://images.unsplash.com/photo-1507842217343-583bb7270b66?w=1920') center/cover;display:flex;align-items:center;justify-content:center;text-align:center;color:white}
.hero h1{font-family:'Playfair Display',serif;font-size:clamp(3rem,8vw,5.8rem);font-weight:900;color:var(--accent);text-shadow:0 8px 20px rgba(0,0,0,0.6)}
.container{max-width:1400px;margin:0 auto;padding:0 30px}
.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:2rem;padding:3rem 0}
.card{background:white;border-radius:20px;overflow:hidden;box-shadow:var(--card-shadow);border:3px solid var(--accent);transition:all .4s}
.card:hover{transform:translateY(-12px);box-shadow:var(--card-shadow-hover)}
.card img{width:100%;height:180px;object-fit:cover}
.content{padding:1.5rem;text-align:center}
.category-badge{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;padding:8px 16px;border-radius:50px;font-size:0.8rem;font-weight:700;margin-bottom:10px}
.card h3{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:800;margin:10px 0}
.action-buttons{display:flex;flex-direction:column;gap:10px;margin-top:15px}
.read-btn,.download-btn{padding:12px;border-radius:12px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px}
.read-btn{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border:none;cursor:pointer}
.download-btn{background:#dc2626;color:white;text-decoration:none}
.add-book-card{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border-radius:20px;padding:3rem 2rem;text-align:center;cursor:pointer;min-height:460px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px}
.add-book-card i{font-size:6rem}
.add-book-card span{font-size:2.2rem;font-weight:900;font-family:'Playfair Display',serif}
.menu-toggle{display:none;position:fixed;top:20px;left:20px;z-index:1002;background:var(--primary);color:white;border:none;width:60px;height:60px;border-radius:50%;font-size:1.8rem;cursor:pointer;box-shadow:0 8px 25px rgba(0,0,0,0.5)}
@media (max-width:992px){body{padding-left:0}.sidebar{transform:translateX(-100%)}.sidebar.active{transform:translateX(0)}.menu-toggle{display:block}}
.upload-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.9);backdrop-filter:blur(12px);z-index:9999;align-items:center;justify-content:center}
.upload-modal.active{display:flex}
.upload-box{background:white;border-radius:24px;width:90%;max-width:500px;padding:3rem 2rem;box-shadow:0 30px 80px rgba(0,0,0,0.4);position:relative}
.upload-box h2{font-size:2.4rem;color:var(--primary);text-align:center;margin-bottom:1.5rem;font-weight:900}
.form-group{margin:1.5rem 0}
.form-group label{display:block;margin-bottom:8px;font-weight:600;color:#333}
.form-group input{width:100%;padding:14px;border:2px solid #ddd;border-radius:12px;font-size:1rem}
.form-group input[type="file"]{padding:40px;background:#f8f9fa;cursor:pointer;border:3px dashed #ccc;border-radius:16px;text-align:center;font-weight:700}
.upload-btn{background:linear-gradient(135deg,var(--primary),var(--secondary));color:white;border:none;padding:16px;border-radius:12px;font-size:1.3rem;font-weight:700;cursor:pointer;width:100%}
.close-upload{position:absolute;top:15px;right:20px;font-size:2.5rem;background:none;border:none;cursor:pointer;color:#999}
</style>
</head>
<body>

<button class="menu-toggle" id="menu-toggle"><i class="fas fa-bars"></i></button>

<aside class="sidebar">
  <div class="sidebar-header">
    <img src="Insignia-New-cuadrado.png" alt="Logo" class="sidebar-logo-big" onerror="this.src='https://via.placeholder.com/158'">
    <h2>Biblioteca<br><span>Sanluisina</span></h2>
  </div>
  <nav style="padding:2rem">
    <a href="examenes.html" style="display:block;padding:1rem 2rem;color:white;text-decoration:none;font-weight:600">Banco de Exámenes</a>
  </nav>
</aside>

<section class="hero">
  <div>
    <h1>BIBLIOTECA DIGITAL SANLUISINA</h1>
    <p style="font-size:1.6rem;margin:1rem 0">IEP San Luis Gonzaga - Huánuco</p>
  </div>
</section>

<div class="container">
  <div class="cards" id="all-container">
    <!-- El botón gigante se crea aquí con JS -->
  </div>
</div>

<!-- MODAL SUBIR LIBRO -->
<div class="upload-modal" id="upload-modal">
  <div class="upload-box">
    <button class="close-upload" onclick="document.getElementById('upload-modal').classList.remove('active')">×</button>
    <h2>Subir Nuevo Libro</h2>
    <div class="form-group">
      <label>Título del libro *</label>
      <input type="text" id="titulo-libro" placeholder="Ej: La Biblia Reina Valera">
    </div>
    <div class="form-group">
      <label>Archivo PDF *</label>
      <input type="file" id="file-libro" accept=".pdf">
    </div>
    <button class="upload-btn" onclick="subirLibro()">SUBIR LIBRO</button>
  </div>
</div>

<script>
const DEPLOY_URL = "https://script.google.com/macros/s/AKfycbztbSGkOzAxM6634AMXvjS9arvg_kpAd4wH70QDrQfNGmc1gbUuwQLfenp4jEcwsRk8/exec";
const CARPETA_ID = "1OTD3mN_Owpp_TbtaWdM8UOOg6naaIT_4";

async function cargarLibros(){
  const cont = document.getElementById('all-container');
  
  // BOTÓN GIGANTE
  const btn = document.createElement('div');
  btn.className = 'add-book-card';
  btn.innerHTML = `<i class="fas fa-cloud-upload-alt"></i><span>Subir nuevo<br>libro</span><small>Click aquí</small>`;
  btn.onclick = () => document.getElementById('upload-modal').classList.add('active');
  cont.appendChild(btn);

  try{
    const res = await fetch(`${DEPLOY_URL}?carpeta=${CARPETA_ID}`);
    const archivos = await res.json();
    archivos.forEach(l=>{
      const n = l.name.replace(/\.pdf$/i,'');
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <img src="https://drive.google.com/thumbnail?id=${l.id}&sz=w400" onerror="this.src='https://via.placeholder.com/400x600/003087/ffffff?text=${encodeURIComponent(n)}'">
        <div class="content">
          <div class="category-badge">Libro</div>
          <h3>${n}</h3>
          <div class="action-buttons">
            <button class="read-btn" onclick="window.open('https://drive.google.com/file/d/${l.id}/preview','_blank')">Leer</button>
            <a href="https://drive.google.com/uc?id=${l.id}&export=download" class="download-btn">Descargar</a>
          </div>
        </div>`;
      cont.appendChild(card);
    });
  }catch(e){
    cont.innerHTML += '<p style="grid-column:1/-1;text-align:center;padding:5rem;color:#999">Error al cargar libros. Verifica permisos de Drive.</p>';
  }
}

function subirLibro(){
  const titulo = document.getElementById('titulo-libro').value.trim();
  const file = document.getElementById('file-libro').files[0];
  if(!titulo || !file) return alert('Falta título o archivo');
  window.open('https://drive.google.com/drive/folders/1OTD3mN_Owpp_TbtaWdM8UOOg6naaIT_4?usp=sharing','_blank');
  document.getElementById('upload-modal').classList.remove('active');
  alert('¡Carpeta abierta! Arrastra tu PDF y ponle el título');
}

document.getElementById('menu-toggle').onclick = () => document.querySelector('.sidebar').classList.toggle('active');
cargarLibros();
</script>
</body>
</html>
